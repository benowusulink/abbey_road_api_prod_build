function e(e,t,i,o){Object.defineProperty(e,t,{get:i,set:o,enumerable:!0,configurable:!0})}var t=globalThis.parcelRequire8ea6,i=t.register;i("8GHbB",function(i,o){e(i.exports,"Login_controller",()=>l);var n=t("dx8Tm"),s=t("eyBzO");class l{constructor(){this.view=new(0,s.Login_view),this.model=new(0,n.Login_model),this.view.submit_web_admin_form(this.controller_submit_web_admin_form),this.view.submit_board_members_form(this.controller_submit_board_members_form),this.model.registerListener(e=>{this.view.render_web_admin_form(e)}),this.model.registerListener(e=>{this.view.render_board_members_form(e)})}controller_submit_web_admin_form=e=>{this.model.website_admin_login(e)};controller_submit_board_members_form=(e,t)=>{this.model.board_member_login(e,t)}}}),i("dx8Tm",function(t,i){e(t.exports,"Login_model",()=>o);class o{constructor(){this.state={web_admin:{loading:!1,failed_login:!1,logged_in:!1},board_member_login:{loading:!1,failed_login:!1,logged_in:!1}},this.listeners=[]}setState=e=>(this.state={...this.state,...e},this.notifyListeners(),console.log(this.state),this.state);getState=e=>{if(this.state[e])return this.state[e];console.log("no state exists")};registerListener=e=>{this.listeners.push(e),e(this.state)};notifyListeners=()=>{this.listeners.forEach(e=>{e(this.state)})};website_admin_login=e=>{this.setState({web_admin:{loading:!0,failed_login:!1,logged_in:!1}}),fetch("https://www.abbeyroad.org.uk/api/login-page/website_admin_login",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:e})}).then(e=>e.json()).then(e=>{e.status?this.setState({web_admin:{loading:!1,failed_login:!1,logged_in:!0}}):this.setState({web_admin:{loading:!1,failed_login:!0,logged_in:!1}})}).catch(e=>{console.log(e),this.setState({web_admin:{loading:!1,failed_login:!0,logged_in:!1}})})};board_member_login=(e,t)=>{this.setState({board_member_login:{loading:!0,failed_login:!1,logged_in:!1}}),fetch("https://www.abbeyroad.org.uk/api/login-page/board_members_login",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,password:t})}).then(e=>e.json()).then(e=>{e.status?(console.log(e),this.setState({board_member_login:{loading:!1,failed_login:!1,logged_in:!0}})):this.setState({board_member_login:{loading:!1,failed_login:!0,logged_in:!1}})}).catch(e=>{this.setState({board_member_login:{loading:!1,failed_login:!0,logged_in:!1}})})}}}),i("eyBzO",function(t,i){e(t.exports,"Login_view",()=>o);class o{constructor(){}submit_web_admin_form=e=>{document.getElementById("website_admin_form").addEventListener("submit",t=>{t.preventDefault(),e(document.getElementById("website_admin_form_password").value)})};render_web_admin_form=e=>{let t=document.getElementById("website_admin_form_loading"),i=document.getElementById("website_admin_form_error_msg");e.web_admin.loading?(t.style.display="none",t.style.display="block"):!1===e.web_admin.loading&&e.web_admin.logged_in?(t.style.display="none",i.style.display="none",window.location.href="/admin.html"):!1===e.web_admin.loading&&e.web_admin.failed_login&&(t.style.display="none",i.style.display="none",i.style.display="flex")};submit_board_members_form=e=>{document.getElementById("board_members_form").addEventListener("submit",t=>{t.preventDefault();let i=document.getElementById("board_members_form_username"),o=document.getElementById("board_members_form_password");e(i.value,o.value)})};render_board_members_form=e=>{let t=document.getElementById("board_members_form_loading"),i=document.getElementById("board_members_form_error_msg");e.board_member_login.loading?(t.style.display="none",t.style.display="block"):!1===e.board_member_login.loading&&e.board_member_login.logged_in?(t.style.display="none",i.style.display="none",window.location.href="/board_members.html"):!1===e.board_member_login.loading&&e.board_member_login.failed_login&&(t.style.display="none",i.style.display="none",i.style.display="flex")}}});
//# sourceMappingURL=controller.0a5dd571.js.map
