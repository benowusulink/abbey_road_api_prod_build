function e(e,i,t,n){Object.defineProperty(e,i,{get:t,set:n,enumerable:!0,configurable:!0})}var i=globalThis.parcelRequire8ea6,t=i.register;t("2TcxR",function(t,n){e(t.exports,"IndexController",()=>d);var s=i("f2W1x"),a=i("1AXD7");class d{constructor(){this.model=new(0,s.IndexModel),this.view=new(0,a.IndexView),this.view.init(),this.get_latest_news_and_events(),this.get_index_page_elements(),this.display_user_email(),this.view.submit_user_email(this.submit_user_email),this.model.get_images().then(e=>{console.log(e),this.view.render_images(e.images)}).catch(e=>{console.log(e)})}display_user_email=()=>{this.model.registerListener(e=>{this.view.display_user_email(e)})};submit_user_email=e=>{this.model.submit_user_email(e)};get_index_page_elements=()=>{this.model.registerListener(e=>{this.view.render_editable_page_elements(e)}),this.model.fetch_index_page_elements()};get_latest_news_and_events=()=>{this.model.registerListener(e=>{this.view.add_news_and_events(e)}),this.model.fetch_latest_news_and_events()}}}),t("f2W1x",function(i,t){e(i.exports,"IndexModel",()=>n);class n{constructor(){this.state={events_and_news_table:{events_table:[],news_table:[],loading:!1,error:null},user_email:{loading:!1,user_email_address:"",user_email_submitted:null},index_page_elements:{loading:!0,a_tag_elements:[],estate_elements:{estate_text:{},estate_images:[]},service_images:[]}},this.listeners=[],this.images=[]}setState=e=>(this.state={...this.state,...e},this.notifyListeners(),console.log(this.state),this.state);registerListener=e=>{this.listeners=[...this.listeners,e],e(this.state)};notifyListeners=()=>{this.listeners.forEach(e=>{e(this.state)})};submit_user_email=e=>{this.setState({user_email:{loading:!0,user_email_address:e,user_email_submitted:null}}),fetch("https://www.abbeyroad.org.uk/api/index-page/submit_user_email",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:this.state.user_email.user_email_address})}).then(e=>e.json()).then(e=>{console.log(e),e.success&&e.data&&this.setState({user_email:{loading:!1,user_email_address:e.data,user_email_submitted:!0}})}).catch(i=>{console.log(i),this.setState({user_email:{loading:!1,user_email_address:e,user_email_submitted:!1}})})};fetch_latest_news_and_events=()=>{this.setState({events_and_news_table:{events_table:[],news_table:[],loading:!0,error:null}}),fetch("https://www.abbeyroad.org.uk/api/index-page/events_and_news").then(e=>e.json()).then(e=>{e.status&&e.data&&this.setState({events_and_news_table:{events_table:[...e.data.events_table],news_table:[...e.data.news_table],loading:!1,error:null}})}).catch(e=>{this.setState({events_and_news_table:{loading:!1,error:e,events_table:[],news_table:[]}})})};get_images=()=>fetch("https://www.abbeyroad.org.uk/api/resident-involvment-page/get_all_images").then(e=>e.json()).then(e=>e.success&&e.data.length>0?(console.log(e),this.images=e.data,Promise.resolve({status:!0,images:this.images})):Promise.reject({status:!1})).catch(e=>(console.log(e),Promise.reject({status:!1})));fetch_index_page_elements=()=>{this.setState({index_page_elements:{loading:!0,a_tag_elements:[],estate_elements:{estate_text:"",estate_images:[]},service_images:[]}}),fetch("https://www.abbeyroad.org.uk/api/index-page/fetch_page_elements").then(e=>e.json()).then(e=>{e.success?this.setState({index_page_elements:{loading:!1,a_tag_elements:e.a_tag_elements,estate_elements:{estate_text:e.estate_text,estate_images:e.estate_images},service_images:e.service_images}}):this.setState({index_page_elements:{loading:!1,a_tag_elements:[],estate_elements:{estate_text:"",estate_images:[]},service_images:[]}})}).catch(e=>{console.log(e),this.setState({index_page_elements:{loading:!1,a_tag_elements:[],estate_elements:{estate_text:"",estate_images:[]},service_images:[]}})})}}}),t("1AXD7",function(i,t){e(i.exports,"IndexView",()=>n);class n{constructor(){this.index_main_article1_div1_span=Array.from(document.getElementsByClassName("index-main-article1-div1-span")),this.index_main_article1_div2=document.getElementById("index-main-article1-div2"),this.index_main_article1_div3=document.getElementById("index-main-article1-div3"),this.index_main_article1_div4=document.getElementById("index-main-article1-div4"),this.index_main_article1_div5_span=Array.from(document.getElementsByClassName("index-main-article1-div5-span")),this.index_main_section1_nav1_span1=Array.from(document.getElementsByClassName("index-main-section1-nav1-span1")),this.index_main_section1_div1=document.getElementById("index-main-section1-div1"),this.index_main_section1_div2=document.getElementById("index-main-section1-div2"),this.index_main_section1_div3=document.getElementById("index-main-section1-div3"),this.index_main_section1_div1_div4=Array.from(document.getElementsByClassName("index-main-section1-div1-div4")),this.events_main_div=document.getElementById("index-main-section1-div2"),this.news_main_div=document.getElementById("index-main-section1-div1"),this.index_main_article_set_timeout=null,this.index_main_section1_set_timeout=null,this.stop_latest_news_rerendering=!1,this.stop_latest_events_rerendering=!1,this.init=()=>{this.index_main_article1_slideshow(),this.index_main_section1_slideshow(),this.event_listeners_for_index_main_section1_and_article1_slideshow()}}index_main_article1_slideshow=()=>{let e=1;this.index_main_article_set_timeout=setInterval(()=>{switch(console.log("index-main-article1 slidwshow working"),this.index_main_article1_div1_span.forEach((e,i)=>{e.classList.remove("index-main-article1-div1-span-selected")}),this.index_main_article1_div5_span.forEach((e,i)=>{e.classList.remove("index-main-article1-div5-span-selected")}),this.index_main_article1_div2.style.display="none",this.index_main_article1_div3.style.display="none",this.index_main_article1_div4.style.display="none",this.index_main_article1_div1_span[e].classList.add("index-main-article1-div1-span-selected"),this.index_main_article1_div5_span[e].classList.add("index-main-article1-div5-span-selected"),e){case 0:this.index_main_article1_div2.style.display="block";break;case 1:this.index_main_article1_div3.style.display="flex";break;case 2:this.index_main_article1_div4.style.display="flex"}e=(e+1)%3},14e3)};index_main_section1_slideshow=()=>{let e=1;this.index_main_section1_set_timeout=setInterval(()=>{switch(console.log("index-main-section1 slidwshow working"),this.index_main_section1_nav1_span1.forEach((e,i)=>{e.classList.remove("index-main-section1-nav1-span1-selected")}),this.index_main_section1_div1.style.display="none",this.index_main_section1_div2.style.display="none",this.index_main_section1_div3.style.display="none",this.index_main_section1_nav1_span1[e].classList.add("index-main-section1-nav1-span1-selected"),e){case 0:this.index_main_section1_div1.style.display="block";break;case 1:this.index_main_section1_div2.style.display="block";break;case 2:this.index_main_section1_div3.style.display="block"}e=(e+1)%3},12e3)};event_listeners_for_index_main_section1_and_article1_slideshow=()=>{this.index_main_article1_div1_span.forEach(e=>{e.addEventListener("click",()=>{switch(this.index_main_article1_div1_span.forEach(e=>{e.classList.remove("index-main-article1-div1-span-selected")}),this.index_main_article1_div5_span.forEach(e=>{e.classList.remove("index-main-article1-div5-span-selected")}),this.index_main_article1_div2.style.display="none",this.index_main_article1_div3.style.display="none",this.index_main_article1_div4.style.display="none",clearInterval(this.index_main_article_set_timeout),e.id){case"index-main-article1-div1-span1":e.classList.add("index-main-article1-div1-span-selected"),this.index_main_article1_div2.style.display="block",this.index_main_article1_div5_span.forEach(e=>{"index-main-article1-div5-span1"===e.id&&e.classList.add("index-main-article1-div5-span-selected")});break;case"index-main-article1-div1-span2":e.classList.add("index-main-article1-div1-span-selected"),this.index_main_article1_div3.style.display="flex",this.index_main_article1_div5_span.forEach(e=>{"index-main-article1-div5-span2"===e.id&&e.classList.add("index-main-article1-div5-span-selected")});break;case"index-main-article1-div1-span3":e.classList.add("index-main-article1-div1-span-selected"),this.index_main_article1_div4.style.display="flex",this.index_main_article1_div5_span.forEach(e=>{"index-main-article1-div5-span3"===e.id&&e.classList.add("index-main-article1-div5-span-selected")})}})}),this.index_main_article1_div5_span.forEach(e=>{e.addEventListener("click",()=>{switch(this.index_main_article1_div1_span.forEach(e=>{e.classList.remove("index-main-article1-div1-span-selected")}),this.index_main_article1_div5_span.forEach(e=>{e.classList.remove("index-main-article1-div5-span-selected")}),this.index_main_article1_div2.style.display="none",this.index_main_article1_div3.style.display="none",this.index_main_article1_div4.style.display="none",clearInterval(this.index_main_article_set_timeout),e.id){case"index-main-article1-div5-span1":e.classList.add("index-main-article1-div5-span-selected"),this.index_main_article1_div2.style.display="block",this.index_main_article1_div1_span.forEach(e=>{"index-main-article1-div1-span1"===e.id&&e.classList.add("index-main-article1-div1-span-selected")});break;case"index-main-article1-div5-span2":e.classList.add("index-main-article1-div5-span-selected"),this.index_main_article1_div3.style.display="flex",this.index_main_article1_div1_span.forEach(e=>{"index-main-article1-div1-span2"===e.id&&e.classList.add("index-main-article1-div1-span-selected")});break;case"index-main-article1-div5-span3":e.classList.add("index-main-article1-div5-span-selected"),this.index_main_article1_div4.style.display="flex",this.index_main_article1_div1_span.forEach(e=>{"index-main-article1-div1-span3"===e.id&&e.classList.add("index-main-article1-div1-span-selected")})}})}),this.index_main_section1_nav1_span1.forEach(e=>{e.addEventListener("click",()=>{switch(this.index_main_section1_nav1_span1.forEach(e=>{e.classList.remove("index-main-section1-nav1-span1-selected")}),this.index_main_section1_div1.style.display="none",this.index_main_section1_div2.style.display="none",this.index_main_section1_div3.style.display="none",clearInterval(this.index_main_section1_set_timeout),e.id){case"index-main-section1-nav1-span1":e.classList.add("index-main-section1-nav1-span1-selected"),this.index_main_section1_div1.style.display="block";break;case"index-main-section1-nav1-span2":e.classList.add("index-main-section1-nav1-span1-selected"),this.index_main_section1_div2.style.display="block";break;case"index-main-section1-nav1-span3":e.classList.add("index-main-section1-nav1-span1-selected"),this.index_main_section1_div3.style.display="flex"}})})};add_news_and_events=e=>{if(e.events_and_news_table.loading)this.index_main_section1_div1_div4.forEach(e=>{e.style.display="flex"});else if(this.index_main_section1_div1_div4.forEach(e=>{e.style.display="none"}),e.events_and_news_table.events_table.length>0||e.events_and_news_table.news_table.length>0){if(e.events_and_news_table.events_table.length>0&&!this.stop_latest_events_rerendering){e.events_and_news_table.events_table.forEach(e=>{let i=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),s=document.createElement("h4"),a=document.createElement("h5"),d=document.createElement("p"),l=document.createElement("a"),c=document.createElement("span");this.events_main_div.append(i),i.append(t,n),t.append(c,s),n.append(a,l),l.appendChild(d),i.classList.add("index-main-section1-div1-div1"),t.classList.add("index-main-section1-div1-div1-div1"),s.classList.add("index-main-section1-div1-div1-div1-h4"),c.classList.add("index-main-section1-div1-div1-div1-h4-span"),n.classList.add("index-main-section1-div1-div1-div2"),a.classList.add("index-main-section1-div1-div1-div2-h5"),l.classList.add("index-main-section1-div1-div1-div2-a"),l.setAttribute("href","./events.html"),d.classList.add("index-main-section1-div1-div1-div2-a-p"),c.textContent=`${e.event_headline}:`,s.textContent=e.event_description,a.textContent=e.event_date,d.textContent="Click here for more Information"});let i=document.createElement("div"),t=document.createElement("a");this.events_main_div.append(i),i.append(t),i.classList.add("index-main-section1-div1-div2"),t.classList.add("index-main-section1-div1-div2-a"),t.setAttribute("href","./events.html"),t.textContent="Click here for More Events",this.stop_latest_events_rerendering=!0}if(e.events_and_news_table.news_table.length>0&&!this.stop_latest_news_rerendering){e.events_and_news_table.news_table.forEach(e=>{let i=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),s=document.createElement("h4"),a=document.createElement("h5"),d=document.createElement("p"),l=document.createElement("a"),c=document.createElement("span");this.news_main_div.append(i),i.append(t,n),t.append(c,s),n.append(a,l),l.appendChild(d),i.classList.add("index-main-section1-div1-div1"),t.classList.add("index-main-section1-div1-div1-div1"),s.classList.add("index-main-section1-div1-div1-div1-h4"),c.classList.add("index-main-section1-div1-div1-div1-h4-span"),n.classList.add("index-main-section1-div1-div1-div2"),a.classList.add("index-main-section1-div1-div1-div2-h5"),l.classList.add("index-main-section1-div1-div1-div2-a"),l.setAttribute("href","./events.html"),d.classList.add("index-main-section1-div1-div1-div2-a-p"),c.textContent=`${e.news_headline}:`,s.textContent=e.news_article,a.textContent=e.news_date,d.textContent="Click here for more Information"});let i=document.createElement("div"),t=document.createElement("a");this.news_main_div.append(i),i.append(t),i.classList.add("index-main-section1-div1-div2"),t.classList.add("index-main-section1-div1-div2-a"),t.setAttribute("href","./news.html"),t.textContent="Click here for More News",this.stop_latest_news_rerendering=!0}}else if(this.index_main_section1_div1_div4.forEach(e=>{e.style.display="none"}),0===e.events_and_news_table.events_table.length||0===e.events_and_news_table.news_table.length){if(0===e.events_and_news_table.events_table.length&&!this.stop_latest_events_rerendering){let e=document.createElement("div"),i=document.createElement("div");this.events_main_div.append(e),e.append(i),e.classList.add("index-main-section1-div1-div3"),e.setAttribute("id","no-events-display"),i.classList.add("index-main-section1-div1-div3-h4"),i.textContent="Currently No Events to Display",this.stop_latest_events_rerendering=!0}if(0===e.events_and_news_table.news_table.length&&!this.stop_latest_news_rerendering){let e=document.createElement("div"),i=document.createElement("div");this.news_main_div.append(e),e.append(i),e.classList.add("index-main-section1-div1-div3"),e.setAttribute("id","no-news-display"),i.classList.add("index-main-section1-div1-div3-h4"),i.textContent="Currently No News to Display",this.stop_latest_news_rerendering=!0}}};display_user_email=e=>{if(console.log(e.user_email),e.user_email.loading){let e=document.getElementById("index-main-section1-div3-span2"),i=document.getElementById("index-main-section1-div3-span2-h5"),t=document.getElementById("index-main-section1-div3-span2-div1");e.style.display="flex",i.style.display="none",t.style.display="block"}else if(!e.user_email.loading&&e.user_email.user_email_submitted){let i=document.getElementById("index-main-section1-div3-span1-input1"),t=document.getElementById("index-main-section1-div3-span2"),n=document.getElementById("index-main-section1-div3-span2-h5"),s=document.getElementById("index-main-section1-div3-span2-div1");t.style.display="flex",n.style.display="flex",s.style.display="none",n.classList.remove("index-main-section1-div3-span2-h5-error"),n.classList.add("index-main-section1-div3-span2-h5-submitted"),n.textContent=`Email Successfully submitted: ${e.user_email.user_email_address}`,i.value=""}else if(!e.user_email.loading&&!1===e.user_email.user_email_submitted){let e=document.getElementById("index-main-section1-div3-span1-input1"),i=document.getElementById("index-main-section1-div3-span2"),t=document.getElementById("index-main-section1-div3-span2-h5"),n=document.getElementById("index-main-section1-div3-span2-div1");i.style.display="flex",t.style.display="flex",n.style.display="none",t.classList.remove("index-main-section1-div3-span2-h5-submitted"),t.classList.add("index-main-section1-div3-span2-h5-error"),t.textContent="Error Submitting Email",e.value=""}};submit_user_email=e=>{let i=document.getElementById("index-main-section1-div3-span1-btn1"),t=document.getElementById("index-main-section1-div3-span1-input1");i.addEventListener("click",()=>{if(t.value.length>0&&t.value.includes("@")&&t.value.includes(".")&&t.value.length>5)e(t.value.trim());else{let e=document.getElementById("index-main-section1-div3-span1-input1"),i=document.getElementById("index-main-section1-div3-span2"),t=document.getElementById("index-main-section1-div3-span2-h5"),n=document.getElementById("index-main-section1-div3-span2-div1");i.style.display="flex",t.style.display="flex",n.style.display="none",t.classList.remove("index-main-section1-div3-span2-h5-submitted"),t.classList.add("index-main-section1-div3-span2-h5-error"),t.textContent=`Error Submitting Email ${e.value}`,e.value=""}})};render_images=e=>{let i=document.getElementById("index-section2-div2-section1-div-img1"),t=document.getElementById("index-section2-div2-section1-div-img2");i.classList.add("fade"),t.classList.add("fade");let n=e.filter(e=>"http://localhost:3001/images/resident-involvment-images/resident-involvment8.webp"!==e.image_dev_url&&"http://localhost:3001/images/resident-involvment-images/resident-involvment9.webp"!==e.image_dev_url),s=e.filter(e=>"http://localhost:3001/images/resident-involvment-images/resident-involvment8.webp"===e.image_dev_url||"http://localhost:3001/images/resident-involvment-images/resident-involvment9.webp"===e.image_dev_url),a=(e,i)=>{e.classList.add("hide"),setTimeout(()=>{e.src=i,e.classList.remove("hide")},1e3)},d=0;n.length>0&&(i.src=n[d].image_prod_url,setInterval(()=>{d=(d+1)%n.length,a(i,n[d].image_prod_url)},5e3));let l=0;s.length>0&&(t.src=s[l].image_prod_url,setInterval(()=>{l=(l+1)%s.length,a(t,s[l].image_prod_url)},15e3))};render_editable_page_elements=e=>{let i=document.getElementById("a_tag1"),t=document.getElementById("a_tag2"),n=document.getElementById("index-section3-article1-div1"),s=document.getElementById("index-section3-article1-div2"),a=document.getElementById("index-section1-section1-div1"),d=document.getElementById("index-section1-section1-div2");if(e.index_page_elements.loading){console.log("loading");let e=document.createElement("div");e.classList.add("loading","index-main-atag-loading"),i.replaceChildren(),i.appendChild(e);let l=document.createElement("div");if(l.classList.add("loading","index-main-atag-loading"),t.replaceChildren(),t.appendChild(l),!document.getElementById("estates_text-loading")){let e=document.createElement("div");e.classList.add("loading"),e.setAttribute("id","estates_text-loading"),n.appendChild(e)}let c=document.createElement("div");c.classList.add("loading"),s.replaceChildren(),s.appendChild(c);let _=document.createElement("div");_.classList.add("loading"),a.replaceChildren(),d.replaceChildren(),a.appendChild(_),d.appendChild(_.cloneNode(!0))}else{e.index_page_elements.a_tag_elements.forEach((e,n)=>{if("a_tag1"===e.id){i.replaceChildren(),i.setAttribute("href",e.production_src);let t=document.createElement("p");t.classList.add("index-main-article1-div2-a1-p"),t.textContent=e.title,i.appendChild(t),console.log(i)}else if("a_tag2"===e.id){t.replaceChildren(),t.setAttribute("href",e.production_src);let i=document.createElement("p");i.classList.add("index-main-article1-div2-a1-p"),i.textContent=e.title,t.appendChild(i)}});let l=document.createElement("p");l.setAttribute("id",e.index_page_elements.estate_elements.estate_text.id),l.textContent=e.index_page_elements.estate_elements.estate_text;let c=document.getElementById("estates_text-loading");console.log(c),n.removeChild(c),n.appendChild(l),s.replaceChildren(),e.index_page_elements.estate_elements.estate_images.forEach(e=>{if("index-section3-article1-div1-img1"===e.id){let i=document.createElement("img");i.setAttribute("id",e.id),i.setAttribute("src",e.production_src),s.appendChild(i)}else if("index-section3-article1-div1-img2"===e.id){let i=document.createElement("img");i.setAttribute("id",e.id),i.setAttribute("src",e.production_src),s.appendChild(i)}}),a.replaceChildren(),d.replaceChildren(),e.index_page_elements.service_images.forEach(e=>{switch(e.id){case"index-section1-section1-div-a-img-r&m":case"index-section1-section1-div-a-img-movp":case"index-section1-section1-div-a-img-caec":case"index-section1-section1-div-a-img-taem":let i=document.createElement("a"),t=document.createElement("img"),n=document.createElement("p");i.classList.add("index-section1-section1-div-a"),i.setAttribute("href","./services.html"),t.classList.add("index-section1-section1-div-a-img"),t.setAttribute("src",e.production_src),t.setAttribute("id",e.id),n.classList.add("index-section1-section1-div-a-p"),n.textContent=e.title,i.append(t,n),a.appendChild(i);break;case"index-section1-section1-div-a-img-lettings":case"index-section1-section1-div-a-img-ha":case"index-section1-section1-div-a-img-governance":case"index-section1-section1-div-a-img-rs":var s=e;let l=document.createElement("a"),c=document.createElement("img"),_=document.createElement("p");l.classList.add("index-section1-section1-div-a"),l.setAttribute("href","./services.html"),c.classList.add("index-section1-section1-div-a-img"),c.setAttribute("src",s.production_src),c.setAttribute("id",s.id),_.classList.add("index-section1-section1-div-a-p"),_.textContent=s.title,l.append(c,_),d.appendChild(l)}})}}}});
//# sourceMappingURL=controller.5302b19b.js.map
