function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t=globalThis.parcelRequire8ea6,o=t.register;o("8GHbB",function(o,n){e(o.exports,"Login_controller",()=>s);var i=t("dx8Tm"),l=t("eyBzO");class s{constructor(){this.view=new(0,l.Login_view),this.model=new(0,i.Login_model),this.view.open_and_close_navbar(),this.view.submit_web_admin_form(this.controller_submit_web_admin_form),this.view.submit_board_members_form(this.controller_submit_board_members_form),this.model.registerListener(e=>{this.view.render_web_admin_form(e)}),this.model.registerListener(e=>{this.view.render_board_members_form(e)})}controller_submit_web_admin_form=e=>{this.model.website_admin_login(e)};controller_submit_board_members_form=(e,t)=>{this.model.board_member_login(e,t)}}}),o("dx8Tm",function(t,o){e(t.exports,"Login_model",()=>n);class n{constructor(){this.state={web_admin:{loading:!1,failed_login:!1,logged_in:!1},board_member_login:{loading:!1,failed_login:!1,logged_in:!1}},this.listeners=[]}setState=e=>(this.state={...this.state,...e},this.notifyListeners(),console.log(this.state),this.state);getState=e=>{if(this.state[e])return this.state[e];console.log("no state exists")};registerListener=e=>{this.listeners.push(e),e(this.state)};notifyListeners=()=>{this.listeners.forEach(e=>{e(this.state)})};website_admin_login=e=>{this.setState({web_admin:{loading:!0,failed_login:!1,logged_in:!1}}),fetch("https://www.abbeyroad.org.uk/api/login-page/website_admin_login",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:e})}).then(e=>e.json()).then(e=>{e.status?this.setState({web_admin:{loading:!1,failed_login:!1,logged_in:!0}}):this.setState({web_admin:{loading:!1,failed_login:!0,logged_in:!1}})}).catch(e=>{console.log(e),this.setState({web_admin:{loading:!1,failed_login:!0,logged_in:!1}})})};board_member_login=(e,t)=>{this.setState({board_member_login:{loading:!0,failed_login:!1,logged_in:!1}}),fetch("https://www.abbeyroad.org.uk/api/login-page/board_members_login",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,password:t})}).then(e=>e.json()).then(e=>{e.status?(console.log(e),this.setState({board_member_login:{loading:!1,failed_login:!1,logged_in:!0}})):this.setState({board_member_login:{loading:!1,failed_login:!0,logged_in:!1}})}).catch(e=>{this.setState({board_member_login:{loading:!1,failed_login:!0,logged_in:!1}})})}}}),o("eyBzO",function(t,o){e(t.exports,"Login_view",()=>n);class n{constructor(){}open_and_close_navbar=()=>{let e=document.getElementById("mobile-menu-btn"),t=document.getElementById("mobile-menu-close"),o=document.getElementById("mobile-menu");e.addEventListener("click",e=>{o.style.display="block"}),t.addEventListener("click",e=>{o.style.display="none"})};submit_web_admin_form=e=>{document.getElementById("website_admin_form").addEventListener("submit",t=>{t.preventDefault(),e(document.getElementById("website_admin_form_password").value)})};render_web_admin_form=e=>{let t=document.getElementById("website_admin_form_loading"),o=document.getElementById("website_admin_form_error_msg");e.web_admin.loading?(t.style.display="none",t.style.display="block"):!1===e.web_admin.loading&&e.web_admin.logged_in?(t.style.display="none",o.style.display="none",window.location.href="/admin.html"):!1===e.web_admin.loading&&e.web_admin.failed_login&&(t.style.display="none",o.style.display="none",o.style.display="flex")};submit_board_members_form=e=>{document.getElementById("board_members_form").addEventListener("submit",t=>{t.preventDefault();let o=document.getElementById("board_members_form_username"),n=document.getElementById("board_members_form_password");e(o.value,n.value)}),document.getElementById("board_members_form_mobile").addEventListener("submit",t=>{t.preventDefault();let o=document.getElementById("board_members_form_mobile_username"),n=document.getElementById("board_members_form_mobile_password");e(o.value,n.value)})};render_board_members_form=e=>{let t=document.getElementById("board_members_form_loading"),o=document.getElementById("board_members_form_error_msg"),n=document.getElementById("board_members_form_mobile_loading"),i=document.getElementById("board_members_form_mobile_error_msg");e.board_member_login.loading?(t.style.display="none",t.style.display="block",n.style.display="none",n.style.display="block"):!1===e.board_member_login.loading&&e.board_member_login.logged_in?(t.style.display="none",o.style.display="none",window.location.href="/board_members.html",n.style.display="none",i.style.display="none",window.location.href="/board_members.html"):!1===e.board_member_login.loading&&e.board_member_login.failed_login&&(t.style.display="none",o.style.display="none",o.style.display="flex",n.style.display="none",i.style.display="none",i.style.display="flex")}}});
//# sourceMappingURL=controller.4e55bccb.js.map
